<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Create Blog Post</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&display=swap"
          rel="stylesheet">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          rel="stylesheet">

    <!-- Quill -->
    <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">

    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body class="bg-light">

<div th:replace="~{fragments/header :: header}"></div>

<div class="container my-5" style="max-width:760px;">
    <h3 class="fw-bold mb-4">Create Blog Post</h3>

    <form method="post" th:action="@{/admin/posts/create}">

        <!-- CSRF -->
        <input type="hidden"
               th:name="${_csrf.parameterName}"
               th:value="${_csrf.token}"/>

        <!-- TITLE -->
        <input class="form-control mb-3"
               name="title"
               placeholder="Post title"
               required>

        <!-- LANGUAGE -->
        <select class="form-select mb-3" name="language" required>
            <option value="">Select Language</option>
            <option value="EN">English</option>
            <option value="KN">Kannada</option>
        </select>

        <!-- CATEGORY (ROLE-BASED) -->
        <select class="form-select mb-4" name="category" required>
            <option value="">Select Category</option>
            <option th:each="cat : ${categories}"
                    th:value="${cat}"
                    th:text="${cat}">
            </option>
        </select>

        <!-- MAIN IMAGE URL -->
        <input class="form-control mb-4"
               name="imageUrl"
               placeholder="Main image URL (optional)">

        <!-- INTRO -->
        <textarea class="form-control mb-4"
                  name="intro"
                  rows="4"
                  placeholder="Short intro paragraph"></textarea>

        <!-- CONTENT -->
        <h6 class="fw-bold mb-2">Post Content</h6>
        <div id="editor" class="bg-white mb-3" style="height:300px;"></div>

        <input type="hidden" name="sectionContent" id="sectionContent">

        <!-- BULLETS -->
        <input class="form-control mb-2"
               name="bulletTitle"
               placeholder="Bullet section heading (optional)">

        <textarea class="form-control mb-4"
                  name="bullets"
                  rows="4"
                  placeholder="One bullet per line"></textarea>

        <!-- TIP -->
        <input class="form-control mb-2"
               name="tipTitle"
               placeholder="Tip title (optional)">

        <textarea class="form-control mb-4"
                  name="tipContent"
                  rows="3"
                  placeholder="Tip explanation"></textarea>

        <!-- PUBLISH -->
        <div class="form-check mb-4">
            <input class="form-check-input"
                   type="checkbox"
                   name="publish"
                   checked>
            <label class="form-check-label">
                Publish immediately
            </label>
        </div>

        <button class="btn btn-dark px-4">Publish</button>
    </form>
</div>

<script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>

<script>
    const quill = new Quill('#editor', {
        theme: 'snow',
        placeholder: 'Write your blog content here...',
        modules: {
            toolbar: [
                [{ header: [1, 2, 3, false] }],
                ['bold', 'italic', 'underline'],
                [{ list: 'ordered' }, { list: 'bullet' }],
                ['link'],
                ['clean']
            ]
        }
    });

    document.querySelector('form').addEventListener('submit', function () {
        document.getElementById('sectionContent').value =
            quill.root.innerHTML.trim();
    });
</script>

</body>
</html>